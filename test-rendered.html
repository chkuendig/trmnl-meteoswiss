<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="https://usetrmnl.com/css/latest/plugins.css">
    <script src="https://usetrmnl.com/js/latest/plugins.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;350;375;400;450;600;700&display=swap" rel="stylesheet">
  <!-- import Highcharts + Chartkick libraries -->
<script src="https://usetrmnl.com/js/highcharts/12.3.0/highcharts.js"></script>
<script src="https://usetrmnl.com/js/highcharts/12.3.0/pattern-fill.js"></script>
<script src="https://usetrmnl.com/js/chartkick/5.0.1/chartkick.min.js"></script>
</head>
  <body class="environment trmnl">
    
    
    
    <div class="screen">
      <div class="view view--half_horizontal">
        <div class="layout">
          <div class="columns">
            <!-- Left Column: Weather Overview -->
            <div class="column">
              <div class="layout layout--col gap--space-between h--full">
                <div>
                  
                  
                  <div style="display: flex; align-items: center; gap: 12px;">
                    <img src="https://usetrmnl.com/images/plugins/weather/wi-cloudy.svg" style="width: 50px; height: 50px;" alt="bedeckt"/>
                    <div class="value value--large">4.4°C</div>
                  </div>
                  <div class="label">bedeckt</div>
                  
                  <!-- 2x3 Grid Layout -->
                  <div style="display: grid; grid-template-columns: auto auto auto auto auto; gap: 8px; margin-top: 12px; width: 100%;">
                    
                      
                      
                      
                      
                      
                      <!-- Row 1 -->
                      <div style="font-size: 14px; font-weight: 600; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">Fri</div>
                      <div style="font-size: 14px; text-align: right; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">0°</div>
                      <div style="font-size: 14px; text-align: center; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">|</div>
                      <div style="font-size: 14px; text-align: left; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">5°</div>
                      <div style="display: flex; justify-content: center; align-items: center;">
                        <img src="https://usetrmnl.com/images/plugins/weather/wi-cloud.svg" style="width: 20px; height: 20px;" alt="bedeckt und trocken"/>
                      </div>
                    
                      
                      
                      
                      
                      
                      <!-- Row 2 -->
                      <div style="font-size: 14px; font-weight: 600; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">Sat</div>
                      <div style="font-size: 14px; text-align: right; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">1°</div>
                      <div style="font-size: 14px; text-align: center; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">|</div>
                      <div style="font-size: 14px; text-align: left; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">5°</div>
                      <div style="display: flex; justify-content: center; align-items: center;">
                        <img src="https://usetrmnl.com/images/plugins/weather/wi-day-cloudy.svg" style="width: 20px; height: 20px;" alt="teilweise sonnig"/>
                      </div>
                    
                  </div>
                </div>
              </div>
            </div>

            <!-- Right Column: Temperature Graph -->
            <div class="column">
              <div id="weather-chart" style="width: 100%; height: 100%;"></div>
            </div>
          </div>
        </div>
        
        <div class="title_bar">
          <img class="image" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IB2cksfwAAAARnQU1BAACxjwv8YQUAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAAuIwAALiMBeKU/dgAAAiJJREFUeNrtW7tuwzAMPAkOGuQLunTtB+T/P6nI1iUJok6uXdeW9ThZpC0BGQJD4t2JIik6Mc45B4XDGENZxx6ZvEoBmOTVCcAmr0qAEuTVCFCKvAoBSpIHgC7XcMksWpr8PwFSDI7nMMXYgrzXA3y7XBrcVuRFxoAtyQ8C3O9wzuEC4O1A5AcBbjfg+cQngI8DkR8EOJ1gAFwAvF+vcM79+czFBN9zLeQHAc5nvIzBF4Dvx+MQO/9rf3wd7sHE7mruvJrDsooajeQX64ApOHYdIIV8lTpAEvlZAVKOQegcBnn23cNq3HmmCN2SgTFgH/gQMNLcPsgDQohpJ796BHwEtZBfw9mFLhBb7MSQn9pgrR2C1caALB3tmV4VipWeBSR0lcZrrOGxtcnnHBnGmob1bpAV8KYpOIRwlvAMAUpG+xh4KTjsXsinxg+7F/Kp86xE8tX7AVvnebaYc4GU5gEpYNeKqLnnot4MpYJKDWK9HWMMvTCacukknvmxCzNE8GG3Jd1eYjMluhCqSX7JNrMy7DSmOublyda40ta4Hkd5gKSd90Xw8ffYpsqiABoqvDmyqbit5vLWV2AF9wz6LJBDXsLPjZcCY1BHKCfgSfytdUyWMACc1l1fi18hnmD3Qj41m3XY+aB3hZX+v4InwN5GE6AJ0ASQ05wonfJ26wE5m2K3NiiJfJYHSBCBgSH5LlCrQGILTxOgpcEmQBOgCaBx/AD7lBdZ6xoOogAAAABJRU5ErkJggg==" />
          
          <span class="title">8055 Zürich</span>
          
          <span class="instance">20:10 Friday, 19 December 2025</span>
        </div>
      </div>
    </div>

    <script type="text/javascript">
      // Calculate proper chart start time (last hour divisible by 3 before current time)
      var graphDataStart = 1766098800000;
      var currentTime = 1766171400000;
      
      // Work with local time
      var currentDate = new Date(currentTime);
      var currentHour = currentDate.getHours();
      
      // Find the last hour divisible by 3
      var chartStartHour = Math.floor(currentHour / 3) * 3;
      
      // Create chart start time with that hour
      var chartStartDate = new Date(currentDate);
      chartStartDate.setHours(chartStartHour, 0, 0, 0);
      var chartStartTime = chartStartDate.getTime();
      
      // Calculate offset from graph data start
      var dataOffsetHours = Math.floor((chartStartTime - graphDataStart) / (1000 * 60 * 60));
      
      // Calculate how many hours since chart start
      var hoursSinceChartStart = (currentTime - chartStartTime) / (1000 * 60 * 60);
      
      // All graph data from JSON
      var allTempData = [0.7,0.5,0.3,0,-0.1,0.1,0.7,0.9,1,1.2,1.5,2.4,3.2,3.7,4.3,4.8,4.9,4.6,4.3,4.3,4.4,3.9,3.7,3.4,3,2.7,2.3,1.9,1.6,1.3,1.2,1.3,1.5,1.9,2.4,3,3.7,4.4,4.9,5.2,5.3,5.2,4.9,4.4,3.9,3.4,3,2.7,2.3,2,1.7,1.5,1.3,1.1,1,1,1.1,1.4,1.7,2.3,2.8,3.4,3.7,3.9,3.9,3.7,3.3,2.8,2.3,1.9,1.6,1.4,1.3,1.1,1,0.9,0.8,0.7,0.5,0.5,0.4,0.6,0.9,1.3,1.9,2.4,2.9,3.1,3.2,3,2.7,2.3,2,1.6,1.4,1.2,1.1,1,0.9,0.8,0.7,0.6,0.5,0.4,0.3,0.4,0.5,0.9,1.3,1.7,2,2.3,2.4,2.3,2.2,1.9,1.7,1.5,1.3,1.2,1.1,1.1,1.1,1.1,1.2,1.3,1.4,1.6,1.7,1.9,2,2.1,2.2,2.2,2.2,2.1,2,1.9,1.7,1.6,1.4,1.3,1.3,1.2,1,0.9,0.7,0.5,0.4,0.3,0.4,0.6,0.9,1.3,1.7,2.1,2.3,2.4,2.4,2.3,2,1.7,1.4,1.1,0.8,0.6,0.4,0.3,0.2,0,-0.1,-0.2,-0.3,-0.3,-0.2,0,0.3,0.7,1.1,1.5,1.9,2.1,2.1,1.9,1.5,1.1,0.6,0.2,-0.2,-0.5,-0.8];
      var allPrecipData = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];
      
      // Extract 24 hours of data starting from our calculated offset
      var temperatureData = [];
      var precipitationData = [];
      
      for (var i = 0; i < 24; i++) {
        var dataIndex = dataOffsetHours + i;
        if (dataIndex >= 0 && dataIndex < allTempData.length) {
          var time = new Date(chartStartTime + (i * 60 * 60 * 1000));
          var hours = String(time.getHours()).padStart(2, '0');
          var minutes = String(time.getMinutes()).padStart(2, '0');
          var timeStr = hours + ':' + minutes;
          
          temperatureData.push([timeStr, allTempData[dataIndex]]);
          precipitationData.push([timeStr, allPrecipData[dataIndex]]);
        }
      }

      var createChart = function() {
        var chart = Highcharts.chart("weather-chart", {
          chart: {
            type: "column",
            height: 220,
            animation: false,
            spacing: [34, 10, 60, 10],
            backgroundColor: "transparent"
          },
          title: { text: null },
          plotOptions: {
            series: {
              animation: false,
              enableMouseTracking: false,
              states: { hover: { enabled: false } },
              pointPadding: 0.02,
              groupPadding: 0.05,
              borderWidth: 0
            }
          },
          series: [
            {
              name: "Precipitation",
              data: precipitationData,
              type: "column",
              color: {
                pattern: {
                  image: "https://usetrmnl.com/images/grayscale/gray-3.png",
                  width: 12,
                  height: 12
                }
              },
              yAxis: 1
            },
            {
              name: "Temperature",
              data: temperatureData,
              type: "spline",
              color: "#000000",
              lineWidth: 3,
              marker: { enabled: false }
            }
          ],
          tooltip: { enabled: false },
          legend: { enabled: false },
          yAxis: [
            {
              title: { 
                text: null
              },
              labels: { 
                style: { fontSize: "14px", color: "#000000" },
                formatter: function () { return this.value + "°C"; }
              },
              gridLineDashStyle: "shortdot",
              gridLineWidth: 1,
              gridLineColor: "#000000",
              tickAmount: 4
            },
            {
              title: {
                text: null
              },
              labels: { 
                style: { fontSize: "14px", color: "#000000" },
                formatter: function () { return this.value + "mm"; }
              },
              gridLineWidth: 0,
              opposite: true
            }
          ],
          xAxis: {
            type: "category",
            tickInterval: 6,
            labels: { 
              style: { fontSize: "12px", color: "#000000" },
              y: 18
            },
            lineWidth: 0,
            gridLineDashStyle: "dot",
            tickWidth: 0,
            gridLineWidth: 1,
            gridLineColor: "#000000",
            title: { text: null },
            plotBands: [
              {
                from: -0.5,
                to: Math.max(0, hoursSinceChartStart - 0.5),
                color: {
                  pattern: {
                    image: "https://usetrmnl.com/images/grayscale/gray-5.png",
                    width: 12,
                    height: 12
                  }
                }
              }
            ]
          },
          credits: { enabled: false }
        });

        // Overlay TRMNL weather icons at every 2-hour mark
        function pickIcon(time, temp, precip) {
          var hour = parseInt(time.split(":")[0], 10);
          var night = hour < 6 || hour >= 18;
          if (precip > 0) return night ? "wi-night-alt-rain" : "wi-day-rain";
          if (night) return "wi-night-alt-cloudy";
          return "wi-day-cloudy";
        }

        var axis = chart.xAxis[0];
        var iconSize = 28;
        var topY = chart.plotTop - iconSize - 4;
        for (var i = 0; i < temperatureData.length; i += 3) {
          var t = temperatureData[i][0];
          var temp = temperatureData[i][1];
          var precip = precipitationData[i][1];
          var slug = pickIcon(t, temp, precip);
          var url = "https://usetrmnl.com/images/plugins/weather/" + slug + ".svg";
          var x = axis.toPixels(i) - iconSize / 2;
          chart.renderer.image(url, x, topY, iconSize, iconSize).add();
        }
      };

      if ("Chartkick" in window) {
        createChart();
      } else {
        window.addEventListener("chartkick:load", createChart, true);
      }
    </script>
  </body>
</html>