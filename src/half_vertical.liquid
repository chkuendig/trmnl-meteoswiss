  <div class="layout" style="width: 100%; height: 100%;">
          <div style="display: flex; flex-direction: column; height: 100%; width: 100%;">
            <!-- Current Weather -->
            <div style="flex: 0 0 auto; margin-bottom: 16px;">
              <div style="display: flex; align-items: center; gap: 16px;">
                {% assign current_icon_id = currentWeather.iconV2 | append: "" %}
                {% assign icon_data = mapping[current_icon_id] %}
                <img src="https://usetrmnl.com/images/plugins/weather/wi-{{ icon_data.icon }}.svg" style="width: 70px; height: 70px;" alt="{{ icon_data.de }}"/>
                <div>
                  <div class="value value--large">{{ currentWeather.temperature | round: 1 }}째C</div>
                  <div class="label label--medium">{{ icon_data.en }}</div>
                </div>
              </div>
            </div>
            
            <!-- Divider -->
            <div class="divider" style="margin: 4px 0;"></div>
            
            <!-- 3-Day Forecast -->
            <div style="flex: 0 0 auto; margin-bottom: 8px;">
              <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px;">
                {% for i in (0..2) %}
                {% assign forecast = regionForecast[i] %}
                {% assign forecast_icon_id = forecast.iconDayV2 | append: "" %}
                {% assign forecast_icon_data = mapping[forecast_icon_id] %}
                {% assign date = forecast.dayDate | date: "%a" %}
                <div style="display: flex; flex-direction: column; align-items: center;">
                  <div class="label" style="font-weight: 600; margin-bottom: 4px;">{{ date | capitalize }}</div>
                  <img src="https://usetrmnl.com/images/plugins/weather/wi-{{ forecast_icon_data.icon }}.svg" style="width: 35px; height: 35px; margin: 4px 0;" alt="{{ forecast_icon_data.de }}"/>
                  <div class="label" style="font-weight: 600;">{{ forecast.temperatureMin }}째 | {{ forecast.temperatureMax }}째</div>
                </div>
                {% endfor %}
              </div>
            </div>
            
            <!-- Chart: 12-hour simplified -->
            <div style="flex: 1; min-height: 0;">
              <div id="weather-chart" style="width: 100%; height: 100%;"></div>
            </div>
          </div>
        </div>
        
        {{ title_bar }}
    <script type="text/javascript">
      // Calculate chart start time (current full hour, max 59min greyed out)
      var graphDataStart = {{ graph.start }};
      var currentTime = {{ currentWeather.time }};
      
      // Work with local time
      var currentDate = new Date(currentTime);
      var currentHour = currentDate.getHours();
      
      // Start at the current full hour
      var chartStartDate = new Date(currentDate);
      chartStartDate.setHours(currentHour, 0, 0, 0);
      var chartStartTime = chartStartDate.getTime();
      
      // Calculate offset from graph data start
      var dataOffsetHours = Math.floor((chartStartTime - graphDataStart) / (1000 * 60 * 60));
      
      // Calculate how many hours since chart start
      var hoursSinceChartStart = (currentTime - chartStartTime) / (1000 * 60 * 60);
      
      // All graph data from JSON
      var allTempData = [{% for i in (0..190) %}{% if i < graph.temperatureMean1h.size %}{{ graph.temperatureMean1h[i] | round: 1 }}{% unless forloop.last %},{% endunless %}{% endif %}{% endfor %}];
      var allPrecipData = [{% for i in (0..190) %}{% if i < graph.precipitationMean1h.size %}{{ graph.precipitationMean1h[i] | round: 1 }}{% unless forloop.last %},{% endunless %}{% endif %}{% endfor %}];
      
      // Extract 12 hours of data starting from our calculated offset
      var temperatureData = [];
      var precipitationData = [];
      
      for (var i = 0; i < 12; i++) {
        var dataIndex = dataOffsetHours + i;
        if (dataIndex >= 0 && dataIndex < allTempData.length) {
          var time = new Date(chartStartTime + (i * 60 * 60 * 1000));
          var hours = String(time.getHours()).padStart(2, '0');
          var minutes = String(time.getMinutes()).padStart(2, '0');
          var timeStr = hours + ':' + minutes;
          
          temperatureData.push([timeStr, allTempData[dataIndex]]);
          precipitationData.push([timeStr, allPrecipData[dataIndex]]);
        }
      }

      var createChart = function() {
        var chart = Highcharts.chart("weather-chart", {
          chart: {
            type: "column",
            height: 230,
            animation: false,
            spacing: [20, 10, 35, 10],
            backgroundColor: "transparent"
          },
          title: { text: null },
          plotOptions: {
            series: {
              animation: false,
              enableMouseTracking: false,
              states: { hover: { enabled: false } },
              pointPadding: 0.02,
              groupPadding: 0.05,
              borderWidth: 0
            }
          },
          series: [
            {
              name: "Precipitation",
              data: precipitationData,
              type: "column",
              color: {
                pattern: {
                  image: "https://usetrmnl.com/images/grayscale/gray-3.png",
                  width: 12,
                  height: 12
                }
              },
              yAxis: 1
            },
            {
              name: "Temperature",
              data: temperatureData,
              type: "spline",
              color: "#000000",
              lineWidth: 5,
              marker: { enabled: false }
            }
          ],
          tooltip: { enabled: false },
          legend: { enabled: false },
          yAxis: [
            {
              title: { 
                text: null
              },
              labels: { 
                style: { fontSize: "18px", color: "#000000", fontWeight: "bold" },
                formatter: function () { return this.value + "째"; }
              },
              gridLineDashStyle: "shortdot",
              gridLineWidth: 2,
              gridLineColor: "#000000",
              tickAmount: 4,
              minTickInterval: 5
            },
            {
              title: {
                text: null
              },
              labels: { 
                style: { fontSize: "18px", color: "#000000", fontWeight: "bold" },
                formatter: function () { return this.value + "mm"; }
              },
              gridLineWidth: 0,
              opposite: true
            }
          ],
          xAxis: {
            type: "category",
            tickInterval: 2,
            labels: { 
              style: { fontSize: "18px", color: "#000000", fontWeight: "bold" },
              y: 18
            },
            lineWidth: 0,
            gridLineDashStyle: "dot",
            tickWidth: 0,
            gridLineWidth: 2,
            gridLineColor: "#000000",
            title: { text: null },
            plotBands: [
              {
                from: -0.5,
                to: Math.max(0, hoursSinceChartStart - 0.5),
                color: {
                  pattern: {
                    image: "https://usetrmnl.com/images/grayscale/gray-5.png",
                    width: 12,
                    height: 12
                  }
                }
              }
            ]
          },
          credits: { enabled: false }
        });
      };

      if ("Chartkick" in window) {
        createChart();
      } else {
        window.addEventListener("chartkick:load", createChart, true);
      }
    </script>